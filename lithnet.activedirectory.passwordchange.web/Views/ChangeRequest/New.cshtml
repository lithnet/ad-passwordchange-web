@{
    ViewBag.Title = "Home Page";
}

@model lithnet.activedirectory.passwordchange.web.Models.PasswordChangeRequestModel

@section Instructions {
    <section>
        <label class="title">Password requirements:</label>
        <p>
            All passwords are checked against a database of 600 million stolen passwords. If you try and use a password that is found in this database, it will be rejected.
            <ul>
                <li>
                    Passwords must not contain your username or any part of your name.
                </li>
                <li>
                    Passwords that are at least 13 characters long do not require any special characters or numbers.
                </li>
                <li>
                    Passwords that are less than 13 characters require at least 3 of the following 4 categories of characters:
                </li>
                <li>
                    Uppercase letters
                </li>
                <li>
                    Lowercase letters
                </li>
                <li>
                    Numbers
                </li>
                <li>
                    Symbols
                </li>
                <li>
                    The minimum password length is 8 characters.
                </li>
            </ul>
        </p>
    </section>
}

<div class="form-container">
    @using (Html.BeginForm("Change", "Do", FormMethod.Post))
    {
        <div class="row">
            <div class="col-md-4 col-md-offset-4 text-center">
                <header>
                    @Resources.Index.HeadingChangePassword
                </header>

                <fieldset>

                    <section>
                        <label class="title">@Resources.Index.CurrentDetails</label>
                        <label class="input-group">
                            <span class="input-group-addon"><i class="glyphicon glyphicon-user text-primary"></i></span>
                            @Html.TextBoxFor(model => model.UserName, new { @class = "dataEntry", @placeholder = Resources.UIMessages.UserName, @id = "user-name", @aria_label = Resources.UIMessages.UserName })
                        </label>
                        <label class="error">
                            @Html.ValidationMessageFor(model => model.UserName)
                        </label>
                        <label class="input-group">
                            <span class="input-group-addon"><i class="glyphicon glyphicon-lock text-primary"></i></span>
                            @Html.PasswordFor(model => model.CurrentPassword, new { @class = "dataEntry", placeholder = Resources.UIMessages.CurrentPassword, @aria_label = Resources.UIMessages.CurrentPassword })
                        </label>
                        <label class="error">
                            @Html.ValidationMessageFor(model => model.CurrentPassword)
                        </label>
                    </section>
                    <section>
                        <label class="title">@Resources.Index.NewDetails</label>
                        <label class="input-group">
                            <span class="input-group-addon"><i class="glyphicon glyphicon-asterisk text-info"></i></span>
                            @Html.PasswordFor(model => model.NewPassword, new { @class = "dataEntry", @placeholder = Resources.UIMessages.NewPassword, @id = "new-password-input", @aria_label = Resources.UIMessages.NewPassword })
                        </label>
                        <label class="error">
                            @Html.ValidationMessageFor(model => model.NewPassword)
                        </label>
                        <label class="input-group">
                            <span class="input-group-addon"><i class="glyphicon glyphicon-ok text-info"></i></span>
                            @Html.PasswordFor(model => model.ConfirmNewPassword, new { @class = "dataEntry", @placeholder = Resources.UIMessages.ConfirmNewPassword, @aria_label = Resources.UIMessages.ConfirmNewPassword })
                        </label>
                        <label class="error">
                            @Html.ValidationMessageFor(model => model.ConfirmNewPassword)
                        </label>
                        <div class="pwstrength_meter"></div>
                    </section>

                    @if (Model?.FailureReason != null)
                    {
                        <section>
                            <b class="error">
                                <i class="fas fa-exclamation-circle"></i> @Html.DisplayTextFor(model => model.FailureReason)
                            </b>
                        </section>
                    }

                    @if (Model?.SecurityAlert != null)
                    {
                        <section>
                            <b class="alert">
                                <i class="fas fa-exclamation-circle"></i> @Html.DisplayTextFor(model => model.SecurityAlert)
                            </b>
                        </section>
                    }

                </fieldset>

                <footer>
                    <div class="center-content">
                        @Html.AntiForgeryToken()
                        <button type="submit" class="btn btn-primary">@Resources.Index.ButtonRequestChange</button>

                        @if (Model?.Redirect != null)
                        {
                            @Html.ActionLink("Cancel", "Redirect", new { redirect = Model.Redirect })
                        }
                    </div>
                </footer>
            </div>
        </div>
    }
</div>